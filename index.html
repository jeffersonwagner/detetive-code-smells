<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detetive de Code Smells</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overscroll-behavior: none; 
        }
        .card {
            width: 100%;
            aspect-ratio: 3 / 2;
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .card:active {
            transform: scale(0.97);
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            border-radius: 0.5rem; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); 
        }

        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 0.5rem; 
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.4rem;
            font-size: 0.7rem; 
			line-height: 1.4;			
            overflow-wrap: break-word;
            word-break: break-word;
        }
        .card-front {
            background-color: #60a5fa; 
            color: white;
        }
        .card-back {
            background-color: #fde047; 
            color: #1f2937; 
            transform: rotateY(180deg); 
        }

        .card.matched .card-inner {
            transform: rotateY(180deg) !important; /* For√ßa a rota√ß√£o */
            opacity: 1 !important; /* Remove a opacidade para simplificar */
        }
        .card.matched .card-front {
            display: none !important; /* For√ßa o desaparecimento da frente */
        }
        .card.matched .card-back {
            background-color: #4ade80 !important; 
            color: #1f2937 !important;
            transform: rotateY(180deg) !important; /* Garante a orienta√ß√£o */
            display: flex !important; /* Garante que est√° vis√≠vel */
            /* Outras propriedades para garantir visibilidade se necess√°rio */
            -webkit-backface-visibility: visible !important;
            backface-visibility: visible !important;
        }
        
        .no-click {
            pointer-events: none;
        }
        
        @media (min-width: 640px) { 
            .card-front, .card-back {
                font-size: 0.75rem; 
                padding: 0.5rem;
            }
        }
        @media (min-width: 768px) { 
            .card-front, .card-back {
                font-size: 0.875rem; 
                padding: 0.6rem;
            }
        }
         @media (min-width: 1024px) { 
            .card-front, .card-back {
                font-size: 0.875rem; 
                padding: 0.75rem;
            }
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            border-radius: 0.5rem;
            text-align: center;
        }
        .modal-button {
            background-color: #3b82f6; 
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 0.25rem;
            cursor: pointer;
            margin-top: 15px;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col items-center justify-center min-h-screen p-4">


    <div class="w-full max-w-3xl mx-auto">
        <div class="flex justify-end mb-2">
            <select id="language-select" class="border border-slate-300 rounded px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-sky-400">
                <option value="pt">Portugu√™s</option>
                <option value="en">English</option>
            </select>
        </div>
        <header class="text-center mb-6">
            <h1 id="main-title" class="text-3xl sm:text-4xl font-bold text-sky-600">Detetive de Code Smells üïµÔ∏è</h1>
            <p id="main-subtitle" class="text-sm sm:text-base text-slate-600 mt-2">Encontre os 8 pares de Code Smells e suas descri√ß√µes!</p>
        </header>

        <div class="bg-white p-4 sm:p-6 rounded-xl shadow-xl mb-6">
            <div class="flex flex-col sm:flex-row justify-around items-center text-center mb-4 space-y-2 sm:space-y-0">
                <div>
                    <span id="label-pairs-found" class="font-semibold">Pares Encontrados: </span>
                    <span id="pairs-found" class="text-lg font-bold text-green-600">0</span>
                </div>
                <div>
                    <span id="label-attempts" class="font-semibold">Tentativas: </span>
                    <span id="attempts" class="text-lg font-bold text-red-600">0</span>
                </div>
            </div>
            <div id="message-area" class="text-center text-blue-600 font-semibold h-6 mb-4"></div>
        </div>
        
        <div id="game-board" class="grid grid-cols-4 gap-2 sm:gap-3 md:gap-4 mb-6">
        </div>

        <div class="text-center">
            <button id="reset-button" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105">
                Reiniciar Jogo
            </button>
        </div>
    </div>
    
    <div id="game-over-modal" class="modal">
        <div class="modal-content bg-white p-6 rounded-lg shadow-xl">
            <h2 id="modal-title" class="text-2xl font-bold mb-4 text-sky-600">Parab√©ns!</h2>
            <p id="modal-message" class="text-slate-700 mb-4">Voc√™ encontrou todos os pares!</p>
            <p class="text-slate-700"><span id="modal-label-attempts">Tentativas:</span> <span id="modal-attempts" class="font-bold">0</span></p>
            <button id="modal-close-button" class="modal-button bg-sky-500 hover:bg-sky-600">Jogar Novamente</button>
        </div>
    </div>

    <script>
        const gameBoard = document.getElementById('game-board');
        const pairsFoundDisplay = document.getElementById('pairs-found');
        const attemptsDisplay = document.getElementById('attempts');
        const resetButton = document.getElementById('reset-button');
        const messageArea = document.getElementById('message-area');
        const languageSelect = document.getElementById('language-select');
        const mainTitle = document.getElementById('main-title');
        const mainSubtitle = document.getElementById('main-subtitle');
        const labelPairsFound = document.getElementById('label-pairs-found');
        const labelAttempts = document.getElementById('label-attempts');
        const modalLabelAttempts = document.getElementById('modal-label-attempts');

        const gameOverModal = document.getElementById('game-over-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const modalAttempts = document.getElementById('modal-attempts');
        const modalCloseButton = document.getElementById('modal-close-button');

        // Dicion√°rio de textos para PT e EN
        const TEXTS = {
            pt: {
                title: 'Detetive de Code Smells üïµÔ∏è',
                subtitle: 'Encontre os 8 pares de Code Smells e suas descri√ß√µes!',
                pairsFound: 'Pares Encontrados: ',
                attempts: 'Tentativas: ',
                reset: 'Reiniciar Jogo',
                foundPair: 'Parab√©ns, voc√™ encontrou um par!',
                notMatch: 'N√£o foi desta vez. Tente novamente!',
                modalTitle: 'üéâ Parab√©ns! üéâ',
                modalMessage: (total) => `Voc√™ encontrou todos os ${total} pares de Code Smells!`,
                modalAttempts: 'Tentativas:',
                modalButton: 'Jogar Novamente',
                codeSmells: [
                    { id: 'longMethod', name: 'Long Method', description: 'Um m√©todo com muitas linhas e/ou responsabilidades.' },
                    { id: 'largeClass', name: 'Large Class', description: 'Uma classe com muitas responsabilidades, m√©todos e atributos.' },
                    { id: 'duplicateCode', name: 'Duplicate Code', description: 'Trechos de c√≥digo id√™nticos ou muito similares em v√°rios lugares.' },
                    { id: 'badNames', name: 'Bad Names', description: 'Vari√°veis, m√©todos ou classes com nomes que n√£o revelam seu prop√≥sito (ex: a, x, processar).' },
                    { id: 'featureEnvy', name: 'Feature Envy', description: 'Um m√©todo que parece mais interessado nos dados de outra classe do que na sua.' },
                    { id: 'dataClass', name: 'Data Class', description: 'Uma classe que possui apenas campos e m√©todos para acess√°-los (get/set), sem comportamento pr√≥prio.' },
                    { id: 'shotgunSurgery', name: 'Shotgun Surgery', description: 'Uma pequena mudan√ßa em uma parte do c√≥digo requer diversas pequenas altera√ß√µes em muitas classes.' },
                    { id: 'messageChains', name: 'Message Chains', description: 'Longa sequ√™ncia de chamadas de m√©todos aninhadas (ex: obj.getA().getB().fazerAlgo()).' },
                    { id: 'primitiveObsession', name: 'Primitive Obsession', description: 'Uso excessivo de tipos primitivos (int, string) em vez de criar pequenas classes para conceitos.' },
                    { id: 'comments', name: 'Comments', description: 'Um m√©todo √© preenchido com coment√°rios explicativos.' },
                    { id: 'longSwitch', name: 'Switch Statements', description: 'Uso excessivo de `switch-case` ou `if-else if` que poderiam ser polimorfismo.' },
                    { id: 'middleMan', name: 'Middle Man', description: 'Uma classe que delega a maior parte do seu trabalho para outra classe, servindo apenas como um canal.' },
                    { id: 'lazyClass', name: 'Lazy Class', description: 'Uma classe que n√£o faz o suficiente para justificar sua exist√™ncia ou manuten√ß√£o.' },
                    { id: 'temporaryField', name: 'Temporary Field', description: 'Um atributo de inst√¢ncia que √© usado apenas em situa√ß√µes espec√≠ficas ou por um curto per√≠odo.' },
                    { id: 'speculativeGenerality', name: 'Speculative Generality', description: 'C√≥digo criado "por via das d√∫vidas" para funcionalidades futuras que nunca s√£o implementadas.' },
                    { id: 'dataClumps', name: 'Data Clumps', description: 'Grupos de vari√°veis que frequentemente aparecem juntas em v√°rias partes do c√≥digo (ex: host, port, user, pass).' },
                    { id: 'longParameterList', name: 'Long Parameter List', description: 'Mais de tr√™s ou quatro par√¢metros para um m√©todo.' },
                    { id: 'refusedBequest', name: 'Refused Bequest', description: 'Se uma subclasse usa apenas alguns dos m√©todos e propriedades herdados, a hierarquia fica desequilibrada.'},
                    { id: 'alternativeClasswithDifferentInterfaces', name: 'Alternative Classes with Different Interfaces', description: 'Duas classes executam fun√ß√µes id√™nticas, mas t√™m nomes de m√©todos diferentes.'},
                    { id: 'divergentChange', name: 'Divergent Change', description: 'Necessidade de alterar muitos m√©todos n√£o relacionados ao fazer altera√ß√µes em uma classe.'},
                    { id: 'parallelInheritanceHierarchies', name: 'Parallel Inheritance Hierarchies', description: 'Sempre que voc√™ cria uma subclasse para uma classe, voc√™ precisa criar uma subclasse para outra classe.'},
                    { id: 'deadCode', name: 'Dead Code', description: 'Uma vari√°vel, par√¢metro, campo, m√©todo ou classe n√£o √© mais usado (geralmente porque est√° obsoleto).'},
                    { id: 'inappropriateIntimacy', name: 'Inappropriate Intimacy', description: 'Uma classe usa os campos e m√©todos internos de outra classe.'},
                    { id: 'incompleteLibraryClass', name: 'Incomplete Library Class', description: 'Bibliotecas que n√£o atendem mais √†s necessidades dos usu√°rios'}
                ]
            },
            en: {
                title: 'Code Smells Detective üïµÔ∏è',
                subtitle: 'Find the 8 pairs of Code Smells and their descriptions!',
                pairsFound: 'Pairs Found: ',
                attempts: 'Attempts: ',
                reset: 'Restart Game',
                foundPair: 'Congratulations, you found a pair!',
                notMatch: 'Not this time. Try again!',
                modalTitle: 'üéâ Congratulations! üéâ',
                modalMessage: (total) => `You found all ${total} pairs of Code Smells!`,
                modalAttempts: 'Attempts:',
                modalButton: 'Play Again',
                codeSmells: [
                    { id: 'longMethod', name: 'Long Method', description: 'A method with too many lines and/or responsibilities.' },
                    { id: 'largeClass', name: 'Large Class', description: 'A class with too many responsibilities, methods, and attributes.' },
                    { id: 'duplicateCode', name: 'Duplicate Code', description: 'Identical or very similar code fragments in several places.' },
                    { id: 'badNames', name: 'Bad Names', description: 'Variables, methods, or classes with names that do not reveal their purpose (e.g., a, x, process).' },
                    { id: 'featureEnvy', name: 'Feature Envy', description: 'A method that seems more interested in the data of another class than its own.' },
                    { id: 'dataClass', name: 'Data Class', description: 'A class that only has fields and methods to access them (get/set), with no own behavior.' },
                    { id: 'shotgunSurgery', name: 'Shotgun Surgery', description: 'A small change in one part of the code requires many small changes in many classes.' },
                    { id: 'messageChains', name: 'Message Chains', description: 'Long sequence of nested method calls (e.g., obj.getA().getB().doSomething()).' },
                    { id: 'primitiveObsession', name: 'Primitive Obsession', description: 'Excessive use of primitive types (int, string) instead of creating small classes for concepts.' },
                    { id: 'comments', name: 'Comments', description: 'A method is filled with explanatory comments.' },
                    { id: 'longSwitch', name: 'Switch Statements', description: 'Excessive use of `switch-case` or `if-else if` that could be polymorphism.' },
                    { id: 'middleMan', name: 'Middle Man', description: 'A class that delegates most of its work to another class, serving only as a channel.' },
                    { id: 'lazyClass', name: 'Lazy Class', description: 'A class that does not do enough to justify its existence or maintenance.' },
                    { id: 'temporaryField', name: 'Temporary Field', description: 'An instance attribute that is only used in specific situations or for a short period.' },
                    { id: 'speculativeGenerality', name: 'Speculative Generality', description: 'Code created "just in case" for future features that are never implemented.' },
                    { id: 'dataClumps', name: 'Data Clumps', description: 'Groups of variables that often appear together in various parts of the code (e.g., host, port, user, pass).' },
                    { id: 'longParameterList', name: 'Long Parameter List', description: 'More than three or four parameters for a method.' },
                    { id: 'refusedBequest', name: 'Refused Bequest', description: 'If a subclass only uses some of the inherited methods and properties, the hierarchy becomes unbalanced.'},
                    { id: 'alternativeClasswithDifferentInterfaces', name: 'Alternative Classes with Different Interfaces', description: 'Two classes perform identical functions but have different method names.'},
                    { id: 'divergentChange', name: 'Divergent Change', description: 'Need to change many unrelated methods when making changes to a class.'},
                    { id: 'parallelInheritanceHierarchies', name: 'Parallel Inheritance Hierarchies', description: 'Whenever you create a subclass for one class, you need to create a subclass for another class.'},
                    { id: 'deadCode', name: 'Dead Code', description: 'A variable, parameter, field, method, or class is no longer used (usually because it is obsolete).'},
                    { id: 'inappropriateIntimacy', name: 'Inappropriate Intimacy', description: 'A class uses the internal fields and methods of another class.'},
                    { id: 'incompleteLibraryClass', name: 'Incomplete Library Class', description: 'Libraries that no longer meet users\' needs'}
                ]
            }
        };

        let currentLang = 'pt';
        let allCodeSmells = TEXTS[currentLang].codeSmells;
        const NUM_PAIRS_IN_GAME = 8;

        let currentGameSmells = [];
        let cards = [];
        let firstCard = null;
        let secondCard = null;
        let lockBoard = false;
        let pairsFound = 0;
        let attempts = 0;
        let totalPairs = NUM_PAIRS_IN_GAME;

        function selectRandomSmells() {
            const shuffledFullList = [...allCodeSmells].sort(() => 0.5 - Math.random());
            currentGameSmells = shuffledFullList.slice(0, NUM_PAIRS_IN_GAME);
        }

        function createCardElements() {
            cards = [];
            currentGameSmells.forEach(smell => {
                cards.push({ type: 'name', id: smell.id, content: smell.name, matched: false });
                cards.push({ type: 'description', id: smell.id, content: smell.description, matched: false });
            });
            shufflePhysicalCards();
        }

        function shufflePhysicalCards() {
            for (let i = cards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cards[i], cards[j]] = [cards[j], cards[i]];
            }
        }

        function renderBoard() {
            gameBoard.innerHTML = '';
            cards.forEach((cardData, index) => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                cardElement.dataset.id = cardData.id;
                cardElement.dataset.type = cardData.type;
                cardElement.dataset.index = index;

                const cardInner = document.createElement('div');
                cardInner.classList.add('card-inner');

                const cardFront = document.createElement('div');
                cardFront.classList.add('card-front');

                const emojiSpan = document.createElement('span');

                if (cardData.type === 'name') {
                    emojiSpan.textContent = 'ü§î';
                } else {
                    emojiSpan.textContent = 'üí°';
                }

                emojiSpan.classList.add('text-3xl', 'sm:text-4xl');
                cardFront.appendChild(emojiSpan);

                const cardBack = document.createElement('div');
                cardBack.classList.add('card-back');
                cardBack.textContent = cardData.content;

                cardInner.appendChild(cardFront);
                cardInner.appendChild(cardBack);
                cardElement.appendChild(cardInner);

                if (cardData.matched) {
                    cardElement.classList.add('matched', 'no-click', 'flipped');
                }

                cardElement.addEventListener('click', () => flipCard(cardElement));
                gameBoard.appendChild(cardElement);
            });
        }

        function flipCard(cardElement) {
            if (lockBoard || cardElement.classList.contains('flipped') || cardElement.classList.contains('matched')) {
                return;
            }
            cardElement.classList.add('flipped');

            if (!firstCard) {
                firstCard = cardElement;
                return;
            }

            secondCard = cardElement;
            lockBoard = true;
            attempts++;
            updateStats();
            checkForMatch();
        }

        function checkForMatch() {
            const firstCardId = firstCard.dataset.id;
            const secondCardId = secondCard.dataset.id;
            const isMatch = firstCardId === secondCardId && firstCard.dataset.index !== secondCard.dataset.index;

            if (isMatch) {
                messageArea.textContent = TEXTS[currentLang].foundPair;
                processMatch();
            } else {
                messageArea.textContent = TEXTS[currentLang].notMatch;
                unflipCards();
            }
        }

        function processMatch() {
            firstCard.classList.add('matched', 'no-click');
            secondCard.classList.add('matched', 'no-click');

            const firstCardDataIndex = parseInt(firstCard.dataset.index);
            const secondCardDataIndex = parseInt(secondCard.dataset.index);
            if (cards[firstCardDataIndex]) cards[firstCardDataIndex].matched = true;
            if (cards[secondCardDataIndex]) cards[secondCardDataIndex].matched = true;

            pairsFound++;
            updateStats();

            if (pairsFound === totalPairs) {
                setTimeout(showGameOverModal, 700);
            }
            resetTurn();
        }

        function unflipCards() {
            setTimeout(() => {
                if (firstCard && !firstCard.classList.contains('matched')) {
                    firstCard.classList.remove('flipped');
                }
                if (secondCard && !secondCard.classList.contains('matched')) {
                    secondCard.classList.remove('flipped');
                }
                resetTurn();
                messageArea.textContent = "";
            }, 2000);
        }

        function resetTurn() {
            [firstCard, secondCard] = [null, null];
            lockBoard = false;
        }

        function updateStats() {
            pairsFoundDisplay.textContent = pairsFound;
            attemptsDisplay.textContent = attempts;
        }

        function showGameOverModal() {
            modalTitle.textContent = TEXTS[currentLang].modalTitle;
            modalMessage.textContent = TEXTS[currentLang].modalMessage(totalPairs);
            modalAttempts.textContent = attempts;
            gameOverModal.style.display = "flex";
        }

        function resetGame() {
            allCodeSmells = TEXTS[currentLang].codeSmells;
            pairsFound = 0;
            attempts = 0;
            lockBoard = false;
            firstCard = null;
            secondCard = null;
            messageArea.textContent = "";
            updateStats();

            selectRandomSmells();
            createCardElements();
            renderBoard();

            gameOverModal.style.display = "none";
            updateStaticTexts();
        }

        function updateStaticTexts() {
            mainTitle.textContent = TEXTS[currentLang].title;
            mainSubtitle.textContent = TEXTS[currentLang].subtitle;
            labelPairsFound.textContent = TEXTS[currentLang].pairsFound;
            labelAttempts.textContent = TEXTS[currentLang].attempts;
            resetButton.textContent = TEXTS[currentLang].reset;
            modalLabelAttempts.textContent = TEXTS[currentLang].modalAttempts;
            modalCloseButton.textContent = TEXTS[currentLang].modalButton;
        }

        resetButton.addEventListener('click', resetGame);
        modalCloseButton.addEventListener('click', () => {
            gameOverModal.style.display = "none";
            resetGame();
        });
        window.onclick = function(event) {
            if (event.target == gameOverModal) {
                gameOverModal.style.display = "none";
                resetGame();
            }
        }

        languageSelect.addEventListener('change', (e) => {
            currentLang = languageSelect.value;
            resetGame();
        });

        // Inicializa√ß√£o
        resetGame();
    </script>
</body>
</html>
